modelscript_version: 0.1
modelscript_components:
  - name: SkippingUarchModel
    from_taxonomic_component: SkippingUarch
    export_attributes_to_model: true
    instance_aliases:
    - alias: C_U_leader_follower_yes_opt_fills
      instances:
      - C_U_leader_follower_yes_opt_fills
    scale_parameters:
      - name: clock
        type: real
        export_as_model_attribute: true
        inherit: true
      - name: technology
        type: string
        export_as_model_attribute: true
        inherit: true
    arch_buffer_action_map:
    - buffer_upstream_of_port: md_in_leader
      upstream_action: metadata_read
      downstream_action: 
        any: fill_leader
    - buffer_upstream_of_port: md_in_follower
      upstream_action: metadata_read
      downstream_action: 
        any: fill_follower
    - buffer_upstream_of_port: pos_out_leader
      upstream_action: read
      downstream_action: 
        any: skip_leader
    - buffer_upstream_of_port: pos_out_follower
      upstream_action: read
      downstream_action: 
        any: skip_follower
    actions:
      - name: fill_leader
        implementations:
        - alias: C_U_leader_follower_yes_opt_fills
          subcomponents: 
          - name: IntersectionLF
            actions:
            - name: fill
          - name: SinglePgenFollower
            actions:
            - name: gated_gen
          - name: SinglePgenFillOptSupport
            actions:
            - name: gated_gen
          - name: FillOptimizerLeader
            actions:
            - name: gated_allow
      - name: fill_follower
#        subcomponents: 
#        - name: IntersectionLF
#          actions:
#          - name: fill
      - name: skip_leader
        implementations:
        - alias: C_U_leader_follower_yes_opt_fills
          subcomponents: 
          - name: IntersectionLF
            actions:
            - name: intersect
          - name: SinglePgenFollower
            actions:
            - name: gen
            - name: count_ref
          - name: SinglePgenFillOptSupport
            actions:
            - name: gated_gen
          - name: FillOptimizerLeader
            actions:
            - name: gated_allow
      - name: skip_follower
        implementations:
        - alias: C_U_leader_follower_yes_opt_fills
          subcomponents: 
          - name: IntersectionLF
            actions:
            - name: gated_intersect
          - name: SinglePgenFollower
            actions:
            - name: gated_gen
          - name: SinglePgenFillOptSupport
            actions:
            - name: gen
            - name: count_ref
          - name: FillOptimizerLeader
            actions:
            - name: allow
    implementations:
      - name: C_U_leader_follower_yes_opt_fills
        taxonomic_instance_alias: C_U_leader_follower_yes_opt_fills
        objective:
          actions:
            - name: fill_leader
              energy: 0
            - name: fill_follower
              energy: 0
            - name: skip_leader
              energy: 0
            - name: skip_follower
              energy: 0
          area: 0
      # - name: LFNF
      #   taxonomic_instance_alias: LFNF
      #   objective:
      #     actions:
      #       - name: fill_leader
      #         energy: 0
      #       - name: fill_follower
      #         energy: 0
      #       - name: skip_leader
      #         energy: 0
      #       - name: skip_follower
      #         energy: 0
      #     area: 0